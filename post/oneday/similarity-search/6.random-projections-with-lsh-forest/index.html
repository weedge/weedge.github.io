<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>译：相似性搜索，第 6 部分：LSH 森林的随机投影 - 时间飘过</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="weedge" />
  <meta name="description" content="了解如何对数据进行哈希处理并通过构造随机超平面来反映其相似性
介绍 在数据科学中，相似性搜索经常出现在 NLP 领域、搜索引擎或推荐系统中，其中需要检索最相关的文档或项目以进行查询。有多种不同的方法可以提高海量数据的搜索性能。
在上一部分中，我们研究了 LSH 的主要范例，即将输入向量转换为低维hash值，同时保留有关其相似性的信息。为了获取hash值（签名），使用了 minhash 函数。在本文中，我们将随机投影输入数据以获得类似的二进制向量。
" />

  <meta name="keywords" content="工作, 技术, 生活" />






<meta name="generator" content="Hugo 0.91.0" />


<link rel="canonical" href="https://weedge.github.io/post/oneday/similarity-search/6.random-projections-with-lsh-forest/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.fa4b2b9f31b5c6d0b683db81157a9226e17b06e61911791ab547242a4a0556f2.css" integrity="sha256-&#43;ksrnzG1xtC2g9uBFXqSJuF7BuYZEXkatUckKkoFVvI=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/copy-to-clipboard.css">


<meta property="og:title" content="译：相似性搜索，第 6 部分：LSH 森林的随机投影" />
<meta property="og:description" content="
了解如何对数据进行哈希处理并通过构造随机超平面来反映其相似性
介绍
在数据科学中，相似性搜索经常出现在 NLP 领域、搜索引擎或推荐系统中，其中需要检索最相关的文档或项目以进行查询。有多种不同的方法可以提高海量数据的搜索性能。
在上一部分中，我们研究了 LSH 的主要范例，即将输入向量转换为低维hash值，同时保留有关其相似性的信息。为了获取hash值（签名），使用了 minhash 函数。在本文中，我们将随机投影输入数据以获得类似的二进制向量。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://weedge.github.io/post/oneday/similarity-search/6.random-projections-with-lsh-forest/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-09-26T21:26:23+08:00" />
<meta property="article:modified_time" content="2023-09-26T21:26:23+08:00" />

<meta itemprop="name" content="译：相似性搜索，第 6 部分：LSH 森林的随机投影">
<meta itemprop="description" content="
了解如何对数据进行哈希处理并通过构造随机超平面来反映其相似性
介绍
在数据科学中，相似性搜索经常出现在 NLP 领域、搜索引擎或推荐系统中，其中需要检索最相关的文档或项目以进行查询。有多种不同的方法可以提高海量数据的搜索性能。
在上一部分中，我们研究了 LSH 的主要范例，即将输入向量转换为低维hash值，同时保留有关其相似性的信息。为了获取hash值（签名），使用了 minhash 函数。在本文中，我们将随机投影输入数据以获得类似的二进制向量。"><meta itemprop="datePublished" content="2023-09-26T21:26:23+08:00" />
<meta itemprop="dateModified" content="2023-09-26T21:26:23+08:00" />
<meta itemprop="wordCount" content="4767">
<meta itemprop="keywords" content="oneday,similarity search,Locality Sensitive Hashing ,lsh,random projections," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="译：相似性搜索，第 6 部分：LSH 森林的随机投影"/>
<meta name="twitter:description" content="
了解如何对数据进行哈希处理并通过构造随机超平面来反映其相似性
介绍
在数据科学中，相似性搜索经常出现在 NLP 领域、搜索引擎或推荐系统中，其中需要检索最相关的文档或项目以进行查询。有多种不同的方法可以提高海量数据的搜索性能。
在上一部分中，我们研究了 LSH 的主要范例，即将输入向量转换为低维hash值，同时保留有关其相似性的信息。为了获取hash值（签名），使用了 minhash 函数。在本文中，我们将随机投影输入数据以获得类似的二进制向量。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->







</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">时间飘过</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/about/">About</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/perf-book-cn/zh/" rel="noopener" target="_blank">
              《现代CPU性能分析与优化》
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      时间飘过
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/about/">About</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://weedge.github.io/perf-book-cn/zh/" rel="noopener" target="_blank">
              《现代CPU性能分析与优化》
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">译：相似性搜索，第 6 部分：LSH 森林的随机投影</h1>
      
      <div class="post-meta">
        <time datetime="2023-09-26" class="post-time">
          2023-09-26
        </time>
        <div class="post-category">
            <a href="https://weedge.github.io/categories/%E6%8A%80%E6%9C%AF/"> 技术 </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#为什么超平面是随机构建的"><strong>为什么超平面是随机构建的？</strong></a></li>
    <li><a href="#为什么-lsh-随机投影也称为树">为什么 LSH 随机投影也称为“树”？</a></li>
  </ul>

  <ul>
    <li><a href="#训练training">训练(Training)</a></li>
    <li><a href="#推理查询inference">推理查询(Inference)</a></li>
  </ul>

  <ul>
    <li><a href="#可视化visualisation">可视化(Visualisation)</a></li>
    <li><a href="#例子">例子</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/0.png" alt=""></p>
<p><strong>了解如何对数据进行哈希处理并通过构造随机超平面来反映其相似性</strong></p>
<h1 id="介绍">介绍</h1>
<p>在数据科学中，相似性搜索经常出现在 NLP 领域、搜索引擎或推荐系统中，其中需要检索最相关的文档或项目以进行查询。有多种不同的方法可以提高海量数据的搜索性能。</p>
<p>在<a href="https://medium.com/towards-data-science/similarity-search-part-5-locality-sensitive-hashing-lsh-76ae4b388203">上一部分</a>中，我们研究了 LSH 的主要范例，即将<em>输入向量转换为低维hash值，同时保留有关其相似性的信息</em>。为了获取hash值（签名），使用了 minhash 函数。在本文中，我们将随机投影输入数据以获得类似的二进制向量。</p>
<h1 id="idea">Idea</h1>
<p>考虑高维空间中的一组点。可以构造一个随机超平面(hyperplane)，充当墙并将每个点分为两个子组之一：正子组positive和负子组negative。正侧的各点被赋予“1”值，负侧的各点被赋予“0”值。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/1.png" alt="img"></p>
<p>​	<em>3D 空间中分隔两点的超平面示例</em></p>
<p>如何确定某个向量的超平面的边？通过使用内积！回到线性代数的本质，给定向量与超平面法向量之间的点积的符号决定了该向量位于哪一侧。这样，每个数据集向量都可以分为两侧之一。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/2.png" alt="img"></p>
<p>​	<em>计算向量与超平面法向量的内积，并与0比较，可以知道向量相对于超平面位于哪一侧</em></p>
<p>显然，用一个二进制值对每个数据集向量进行编码是不够的。也就是说，应该构造几个随机超平面，因此每个向量都可以根据其与特定超平面的相对位置用许多 0 和 1 值进行编码。如果两个向量具有完全相同的二进制代码，则表明所构造的超平面都无法将它们分成不同的区域。因此，他们在现实中很可能非常接近。</p>
<p>为了找到给定查询的最近邻居，通过检查其与所有超平面的相对位置以相同的方式用 0 和 1 编码查询就足够了。可以将找到的查询二元向量与为数据集向量获得的所有其他二元向量进行比较。这可以通过使用汉明距离线性完成。</p>
<blockquote>
<p><strong>两个向量之间的汉明距离(Hamming distance)</strong> 是它们的值不同的位置的数量。</p>
</blockquote>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/3.png" alt="img"></p>
<p>​	<em>计算汉明距离的示例。左边的一对向量彼此更相似，因为它们的汉明距离更小。</em></p>
<p>与查询的汉明距离最小的二元向量被视为候选向量，然后与初始查询进行充分比较。</p>
<p>(<strong>注</strong>： <a href="https://github.com/weedge/doraemon-nb/blob/main/lsh_hyperplanes.ipynb">lsh_hyperplanes.ipynb</a> 实操笔记)</p>
<h2 id="为什么超平面是随机构建的"><strong>为什么超平面是随机构建的？</strong></h2>
<p>在当前阶段，要求为什么超平面以随机方式构建而不是确定性的，意味着可以自定义规则，定义用于分离数据集点，似乎是合乎逻辑的。这背后有两个主要原因：</p>
<ul>
<li>首先，确定性方法无法推广算法并可能导致过度拟合。</li>
<li>其次，随机性允许对算法的性能做出不依赖于输入数据的概率陈述。对于确定性方法来说，这是行不通的，因为它可能对一个数据表现良好，但对另一数据表现不佳。一个很好的类比是确定性<a href="https://medium.com/@slavahead/quick-sort-explained-and-visualised-866cae28308e">快速排序</a>算法，其平均运行时间为<em>O(n * log n)</em>。然而，它适用于O(n²)最坏情况下排序数组上的时间。如果有人了解算法的工作流程，那么该信息可以通过始终提供最坏情况的数据来明显损害系统的效率。这就是为什么随机快速排序更受欢迎的原因。随机超平面也会发生绝对类似的情况。</li>
</ul>
<h2 id="为什么-lsh-随机投影也称为树">为什么 LSH 随机投影也称为“树”？</h2>
<p>随机投影方法有时称为<strong>LSH 树</strong>。这是因为hash码分配的过程可以用决策树的形式表示，其中每个节点包含向量是否位于当前超平面的负侧或正侧的条件。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/4.png" alt="img"></p>
<p>​	<em>第一个节点检查向量相对于红色超平面位于哪一侧。第二层的节点检查相同的条件，但相对于绿色超平面。最后，第三级检查蓝色超平面的相对位置。基于这 3 个条件，为向量分配一个 3 位hash值。</em></p>
<h1 id="超平面森林">超平面森林</h1>
<p>超平面是随机构造的。这可能会导致如下图所示的数据集点分离不佳的情况。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/5.png" alt="img"></p>
<p><em>构造 4 个超平面以将数据集点表示为 4 长度的二进制向量。尽管 D 点和 E 点具有相同的hash码，但它们彼此相距相对较远（FP）。相反的情况发生在一对位于不同区域但彼此非常接近的点 E 和 F (FN) 上。考虑到汉明距离，该算法通常预测 D 点比 F 点更接近 E。</em></p>
<p>从技术上讲，当两个点具有相同的hash码但彼此相距很远时，这并不是什么大问题。在算法的下一步中，这些点将被作为候选点并进行充分比较——这样算法就可以消除 <em>假阳性(false positive)</em> 误报情况。<em>假阴性(false negatives)</em> 漏报情况更加复杂：当两个点具有不同的hash码但实际上彼此接近时。</p>
<p>为什么不使用与经典机器学习中的决策树相同的方法，将其组合成随机森林来提高整体预测质量？<em>如果一个估计器犯了错误，其他估计器可以产生更好的预测并减轻最终的预测误差</em>。利用这个想法，构建随机超平面的过程可以独立重复。生成的hash值可以聚合为一对向量，其方式与上一章中的 minhash 值类似：</p>
<blockquote>
<p><em>如果查询与另一个向量至少有一次相同的hash码，则它们被视为候选者</em>。</p>
</blockquote>
<p>使用这种机制可以减少<em>假阴性</em>的数量。</p>
<h1 id="质量与速度的权衡quality-vs-speed-trade-off">质量与速度的权衡(Quality vs speed trade-off)</h1>
<p>选择适当数量的超平面在数据集上运行非常重要。选择的超平面越多来划分数据集点，冲突就越少，计算hash码所需的时间就越多，存储它们的内存也就越多。确切地说，如果一个数据集由<em>n 个</em>向量组成，并且我们将其分割为<em>k 个</em>超平面，那么平均每个可能的hash码将被分配给<em>n / 2ᵏ</em>个向量。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/6.png" alt="img"></p>
<p>​	<em>k = 3 产生 2³ = 8 个桶</em></p>
<h1 id="复杂complexity">复杂(Complexity)</h1>
<h2 id="训练training">训练(Training)</h2>
<p>LSH Forest 训练阶段由两部分组成：</p>
<ol>
<li><em>k个超平面的生成</em>。这是一个相对较快的过程，因为<em>d</em>维空间中的单个超平面可以在 <em>O(d)</em> 时间内生成。</li>
<li><em>为所有数据集向量分配hash码</em>。此步骤可能需要时间，尤其是对于大型数据集。获取单个hash码需要 <em>O(dk)</em> 的时间。如果数据集由 n个向量组成，则总复杂度变为<em>O(ndk)</em>。</li>
</ol>
<p>对于森林中的每棵树，上述过程都会重复几次。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/7.png" alt="img"></p>
<p>​	<em>训练复杂性</em></p>
<h2 id="推理查询inference">推理查询(Inference)</h2>
<p>LSH 森林的优点之一是其快速推理查询，包括两个步骤：(k 超平面个数，d 维数，n 数据集向量数)</p>
<ol>
<li><em>获取查询的hash码</em>。这相当于计算<em>k</em> 个标量积，结果为 <em>O(dk)</em> 时间。</li>
<li>通过计算到候选者的精确距离，在同一存储桶（具有相同hash码的向量）中查找距查询最近的邻居。对于O(d) ，距离计算呈线性进行。每个桶平均包含n / 2ᵏ个向量。因此，计算到所有潜在候选者的距离需要O(dn / 2ᵏ)的时间。</li>
</ol>
<p>总复杂度为 <em>O(dk + dn / 2ᵏ)</em> 。</p>
<p>像往常一样，对于森林中的每棵树，上述过程都会重复几次。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/8.png" alt="img"></p>
<p>​	<em>推理查询复杂度</em></p>
<p>当超平面<em>k</em>的数量选择为<em>n ~ 2ᵏ</em>（在大多数情况下是可能的）时，总推理复杂度变为 <em>O(ldk)</em>  （ <em>l</em> 是树的数量）。基本上，这意味着 <strong>计算时间不取决于数据集大小！</strong> 这种微妙之处导致了对数百万甚至数十亿向量的相似性搜索的有效可扩展性。</p>
<h1 id="错误率error-rate">错误率(Error rate)</h1>
<p>在有关 LSH 的文章的前一部分中，我们讨论了如何根据两个向量的签名相似性来确定两个向量被选为候选向量的概率。在这里，我们将使用几乎相同的逻辑来找到 LSH 森林的公式。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/9.png" alt="img"></p>
<p>​	<em>令 s 为两个向量在其hash值的相同位置具有相同位的概率（稍后将估计 s）</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/10.png" alt="img"></p>
<p>​	<em>两个向量的长度为 k 的hash码相等的概率</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/11.png" alt="img"></p>
<p>​	<em>两个向量的长度为 k 的hash码不同（或至少一位不同）的概率</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/12.png" alt="img"></p>
<p>​	<em>两个向量的所有 l 个hash码（对于 l 个超平面）都不同的概率</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/13.png" alt="img"></p>
<p>​	<em>两个向量的 l 个hash码中至少有一个相等的概率，因此向量将成为候选向量</em></p>
<p>到目前为止，我们几乎已经得到了估计两个向量成为候选向量的概率的公式。剩下的唯一事情就是估计方程中变量<em>s</em>的值。在经典的LSH算法中，<em>s</em>等于两个向量的Jaccard系数或签名相似度。另一方面，为了估计LSH 森林的<em>s</em>，将使用线性代数理论。</p>
<p>坦率地说，<em>s</em>是两个向量<em>a</em>和<em>b</em>具有相同位的概率。该概率相当于随机超平面将这些向量分离到同一侧的概率。让我们想象一下：</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/14.png" alt="img"></p>
<p>向量 a 和 b 由蓝色超平面分隔。绿色超平面没有将它们分开。</p>
<p>从图中可以清楚地看出，只有当向量<em>a</em>和<em>b从向量 a 和 b 之间经过时，超平面才会将它们分成两个不同的边。<em>这种概率</em>q</em>与向量之间的角度成正比，可以轻松计算：</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/15.png" alt="img"></p>
<p>​	<em>随机超平面分隔两个向量的概率（即它们具有不同的位）</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/16.png" alt="img"></p>
<p>​	<em>随机超平面不分离两个向量的概率（即，它们具有相同的位）</em></p>
<p>将这个方程代入之前获得的方程得出最终公式：</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/17.png" alt="img"></p>
<p>​	<em>基于超平面数 k 和 LSH 树数 l 两个向量具有至少一个对应hash值（即成为候选者）的概率</em></p>
<h2 id="可视化visualisation">可视化(Visualisation)</h2>
<p><em>注意</em>：余弦相似度正式定义在范围 [-1, 1] 中。为简单起见，我们将此区间映射到 [0, 1]，其中 0 和 1 分别表示最低和最高可能的相似度。</p>
<p>利用最后获得的公式，让我们根据不同数量的超平面 <em>k</em> 和树 <em>l</em> 的余弦相似度来可视化两个向量作为候选向量的概率。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/18.png" alt="img"></p>
<p>​	<em>调整树的数量 l</em></p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/19.png" alt="img"></p>
<p>​	<em>调整超平面数量k</em></p>
<p>根据这些图，可以进行一些有用的观察：</p>
<ul>
<li>余弦相似度为 1 的一对向量总是成为候选向量。</li>
<li>余弦相似度为 0 的一对向量永远不会成为候选向量。</li>
<li>当超平面 <em>k</em> 的数量减少或 LSH 树 <em>l</em> 的数量增加时，两个向量成为候选的概率 <em>P</em> 增加（即更多 <em>假阳性 false positives</em> 误报）。相反的说法是正确的。</li>
</ul>
<p>综上所述，LSH是一种非常灵活的算法：可以根据给定的问题调整不同的 <em>k</em> 和 <em>l</em> 值，得到满足问题要求的概率曲线。</p>
<h2 id="例子">例子</h2>
<p>让我们看下面的例子。想象一下<em>l = 5</em>棵树， 用<em>k = 10 个</em>超平面构建的树。除此之外，还有两个向量的余弦相似度为0.8。在大多数系统中，这种余弦相似性表明向量确实彼此非常接近。根据前面几节的结果，这个概率只有 2.5%！显然，对于如此高的余弦相似度来说，这是一个非常低的结果。使用<em>l = 5</em>和<em>k = 10</em>这些参数会 导致大量 <em>假阴性 false negatives</em> 漏报！下面的绿线代表这种情况下的概率。</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/20.png" alt="img"></p>
<p>基于两个向量余弦相似度的概率曲线</p>
<p>这个问题可以通过调整<em>k</em>和<em>l</em>的更好值来将曲线向左移动来解决。</p>
<p>例如，如果<em>k</em>减小到 3（红线），则余弦相似度 0.8 的相同值将对应于 68% 的概率，这比以前更好。乍一看，红线似乎比绿线更适合，但请务必记住，使用较小的<em>k</em>值（如红线的情况）会导致大量碰撞。这就是为什么有时最好调整第二个参数，即树的数量<em>l</em>。</p>
<p>与<em>k</em>不同，它通常需要非常多的树 <em>l</em> 才能获得相似的线形状。在图中，蓝线是通过将 <em>l</em> 值从 10 更改为 500 从绿线获得的。蓝线显然比绿线拟合得更好，但仍远非完美：因为余弦之间的斜率很高相似度值为0.6和0.8时，余弦相似度在0.3-0.5附近的概率几乎等于0，这是不利的。文档相似度为 0.3-0.5 的小概率在现实生活中通常应该更高。</p>
<p>根据最后一个例子，很明显，即使树的数量非常多（需要大量计算），仍然会导致许多<em>漏报</em>！这是随机投影方法的主要缺点：</p>
<blockquote>
<p>尽管有可能获得完美的概率曲线，但它要么需要大量计算，要么会导致大量冲突。否则，会导致较高的假阴性漏报率。</p>
</blockquote>
<h1 id="faiss实现">FAISS实现</h1>
<p><a href="https://faiss.ai/">根据Faiss文档</a>中的信息，我们将了解如何构建LSH索引。</p>
<p><em>随机投影</em>算法在 Faiss 中的IndexLSH类中实现。尽管 Faiss 作者使用了另一种称为“随机旋转”的技术，但它仍然与本文中描述的技术有相似之处。<strong>该类仅实现一个 LSH 树。如果我们想使用 LSH 森林，那么只需创建几个 LSH 树并聚合它们的结果就足够了</strong>。</p>
<p><em>IndexLSH</em>类的构造函数有两个参数：</p>
<ul>
<li><strong>d</strong>：维数</li>
<li><strong>nbits</strong>：编码单个向量所需的位数（可能的桶数等于<em>2ⁿᵇᶦᵗˢ</em>）</li>
</ul>
<blockquote>
<p>search() 方法返回的距离是到查询向量的汉明距离。</p>
</blockquote>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/21.png" alt="img"></p>
<p><em>IndexLSH 的 Faiss 实现</em></p>
<p>此外，Faiss 允许通过调用*faiss.vector_to_array(index.codes)*方法检查每个数据集向量的编码hash值。</p>
<p>由于每个数据集向量均由<em>nbits</em>二进制值编码，因此存储单个向量所需的字节数等于：</p>
<p><img src="https://github.com/weedge/mypic/raw/master/oneday/random-projections-with-lsh-forest/22.png" alt="img"></p>
<h1 id="johnson-lindenstrauss-lemma">Johnson-Lindenstrauss lemma</h1>
<p><a href="https://cs.stanford.edu/people/mmahoney/cs369m/Lectures/lecture1.pdf">Johnson-Lindenstrauss lemma</a>是一个与降维相关的引理。虽然可能很难完全理解其原始陈述，但可以用简单的语言表述：</p>
<blockquote>
<p>选择随机子集并将原始数据投影到其上可以保留点之间相应的成对距离。</p>
</blockquote>
<p>更准确地说，拥有<em>n 个</em>点的数据集，可以在<em>O(logn)<em>维的新空间中表示它们，从而几乎保留点之间的相对距离。如果向量在 LSH 方法中由</em>~logn</em>二进制值编码，则可以应用引理。此外，LSH 完全按照引理要求以随机方式创建超平面。</p>
<p>Johnson-Lindenstrauss 引理的另一个令人难以置信的事实是，<strong>新数据集的维数不依赖于原始数据集的维数</strong>！实际上，这个引理对于非常小的维度来说效果不佳。</p>
<h1 id="结论">结论</h1>
<p>我们已经使用了强大的相似性搜索算法。基于通过随机超平面分离点的简单想法，它通常在大型数据集上表现良好并且可扩展。此外，它具有良好的灵活性，允许选择适当数量的超平面和树。</p>
<p>Johnson-Lindenstrauss 引理的理论结果强化了随机预测方法的使用。</p>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Random_projection">https://en.wikipedia.org/wiki/Random_projection</a></li>
<li><a href="http://infolab.stanford.edu/~bawa/Pub/similarity.pdf">LSH Forest: Self-Tuning Indexes for Similarity Search</a></li>
<li><a href="https://cs.stanford.edu/people/mmahoney/cs369m/Lectures/lecture1.pdf">The Johnson-Lindenstrauss Lemma</a></li>
<li><a href="https://faiss.ai/">Faiss documentation</a></li>
<li><a href="https://github.com/facebookresearch/faiss">Faiss repository</a></li>
<li><a href="https://github.com/facebookresearch/faiss/wiki/Faiss-indexes">Summary of Faiss indexes</a></li>
</ul>
<p><em>除非另有说明，所有图片均由作者提供</em>。</p>
<p>原文地址： <a href="https://towardsdatascience.com/similarity-search-part-6-random-projections-with-lsh-forest-f2e9b31dcc47">https://towardsdatascience.com/similarity-search-part-6-random-projections-with-lsh-forest-f2e9b31dcc47</a></p>
<p><strong>附操作笔记</strong>:</p>
<p><a href="https://github.com/weedge/doraemon-nb/blob/main/lsh_hyperplanes.ipynb"><strong>lsh_hyperplanes.ipynb</strong></a></p>
<p><a href="https://github.com/weedge/doraemon-nb/blob/main/lsh_random_projection_simp.ipynb"><strong>lsh_random_projection_simp.ipynb</strong></a></p>
<p><a href="https://github.com/weedge/doraemon-nb/blob/main/lsh_sparse_implementation.ipynb"><strong>lsh_sparse_implementation.ipynb</strong></a></p>
<p><a href="https://github.com/weedge/doraemon-nb/blob/main/faiss_lsh_implementation.ipynb"><strong>faiss_lsh_implementation.ipynb</strong></a></p>
<p><a href="https://github.com/weedge/doraemon-nb/blob/main/faiss_locality_sensitive_hashing_random_projection.ipynb"><strong>faiss_locality_sensitive_hashing_random_projection.ipynb</strong></a> 学习笔记</p>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">weedge</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2023-09-26
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://weedge.github.io/tags/oneday/">oneday</a>
          <a href="https://weedge.github.io/tags/similarity-search/">similarity search</a>
          <a href="https://weedge.github.io/tags/locality-sensitive-hashing/">Locality Sensitive Hashing </a>
          <a href="https://weedge.github.io/tags/lsh/">lsh</a>
          <a href="https://weedge.github.io/tags/random-projections/">random projections</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/oneday/similarity-search/7.lsh-compositions/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">译：相似性搜索，第 7 部分：LSH 组合</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/oneday/similarity-search/5.locality-sensitive-hashing/">
            <span class="next-text nav-default">译：相似性搜索，第 5 部分：局部敏感哈希 (LSH)</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    显示 Disqus 评论
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://weedge.github.io/post/oneday/similarity-search/6.random-projections-with-lsh-forest/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'weedge';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:weege007@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/weedge" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://weibo.com/weedge" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>


<a href="https://weedge.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2013 -
    2025
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        weedge
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  









  <script id="dsq-count-scr" src="//weedge.disqus.com/count.js" async></script>






  <script src="/js/copy-to-clipboard.js"></script>


</body>
</html>
